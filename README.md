# Telegram-бот «Цитаты известных женщин»

Бот для Telegram, который по нажатию на кнопку отправляет цитату одной из четырёх авторок:

- Рената Литвинова
- Фаина Раневская
- Лиля Брик
- Татьяна Толстая

## Как работает логика бота

1. Пользователь запускает бота командой `/start`.
2. Бот отвечает приветственным сообщением и показывает inline-клавиатуру с четырьмя кнопками — по имени каждой женщины.
3. Пользователь нажимает на кнопку с именем нужной авторки.
4. Бот:
   - получает `callback_data` (внутренний ключ авторки),
   - случайным образом выбирает одну цитату из списка для этой авторки,
   - отправляет текст: имя авторки + цитата,
   - снова показывает клавиатуру с выбором авторок.
5. Пользователь может нажимать на имена сколько угодно раз и получать новые цитаты.

Финальный результат любого взаимодействия — текстовая цитата выбранной авторки.

Дополнительно реализована команда `/help`, которая объясняет, как пользоваться ботом и дублирует клавиатуру выбора.

## Структура проекта

```text
.
├── app
│   ├── __init__.py        # помечает каталог как модуль Python
│   ├── main.py            # точка входа, запуск бота, вебхуки / polling
│   └── texts.py           # все тексты, авторы, цитаты и клавиатуры
├── requirements.txt       # зависимости проекта
├── render.yaml            # Blueprint-конфигурация для Render.com
└── README.md              # описание проекта и инструкции
```

### `app/texts.py`

Содержит:

- `AUTHORS` — словарь ключей (`callback_data`) и полных имён авторок.
- `QUOTES` — наборы оригинальных цитат в стиле каждой авторки.
- `START_MESSAGE` и `HELP_MESSAGE` — приветствие и текст помощи.
- `build_authors_keyboard()` — функция, создающая inline-клавиатуру с четырьмя кнопками.
- `build_quote_text(full_name, quote)` — функция, формирующая текст сообщения с цитатой.

### `app/main.py`

Содержит:

- регистрацию обработчиков команд `/start` и `/help`;
- обработчик `handle_author_choice` для inline-кнопок;
- логику выбора случайной цитаты и сборки финального текста;
- настройку и запуск бота в режиме вебхуков (для Render.com);
- резервный запуск в режиме polling (для локальной разработки).

## Запуск локально

1. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

2. Создайте бота в BotFather и получите токен.

3. Установите переменные окружения:

   ```bash
   export BOT_TOKEN="ВАШ_ТОКЕН_ОТ_BOTFATHER"
   # Для локального polling WEBHOOK_BASE_URL можно не задавать
   ```

4. Запустите бота:

   ```bash
   python -m app.main
   ```

   В этом случае, если не задан `WEBHOOK_BASE_URL` и `RENDER_EXTERNAL_URL`,
   бот автоматически стартует в режиме polling и будет сам опрашивать Telegram.

## Деплой на Render.com (бесплатный план, Blueprint)

1. Создайте новый репозиторий на GitHub и загрузите в него файлы из этого проекта.

2. На Render.com выберите деплой **Blueprint** и укажите ссылку на ваш репозиторий.

3. Render прочитает файл `render.yaml` и создаст Web Service с типом `web`, планом `free`
   и командой запуска `python -m app.main`.

4. В настройках сервиса на Render:
   - задайте переменную окружения `BOT_TOKEN` — токен, который вы получили в BotFather;
   - после первого деплоя Render автоматически задаёт переменную `RENDER_EXTERNAL_URL`,
     и приложение сможет использовать её для формирования корректного `webhook_url`.

   В большинстве случаев не нужно вручную задавать `WEBHOOK_BASE_URL`, так как
   будет использоваться `RENDER_EXTERNAL_URL`.

5. После успешного запуска:
   - приложение стартует, прочитает переменные окружения,
   - определит внешний URL сервиса,
   - зарегистрирует вебхук в Telegram по адресу вида:

     ```text
     https://<имя-сервиса>.onrender.com/telegram-webhook
     ```

   - Telegram начнёт слать апдейты на этот URL, а бот будет отвечать на сообщения пользователей.

## Переменные окружения

- `BOT_TOKEN` — **обязательно**, токен Telegram-бота.
- `WEBHOOK_BASE_URL` — опционально. Можно использовать для ручного указания базового URL.
- `RENDER_EXTERNAL_URL` — автоматически создаётся Render.com и используется, если `WEBHOOK_BASE_URL` не задан.
- `PORT` — порт, задаётся Render.com автоматически. Локально по умолчанию используется `10000`.

## Почему всё работает бесплатно

- Используется только Python и библиотека `python-telegram-bot`.
- Нет внешних платных API или баз данных.
- Конфигурация `render.yaml` создаёт бесплатный Web Service на Render.com.
- Вебхуки реализованы стандартными средствами библиотеки и платформы, без дополнительных платных сервисов.
